var j=t=>{throw TypeError(t)};var rA=(t,A,e)=>A.has(t)||j("Cannot "+e);var z=(t,A,e)=>A.has(t)?j("Cannot add the same private member more than once"):A instanceof WeakSet?A.add(t):A.set(t,e);var L=(t,A,e)=>(rA(t,A,"access private method"),e);(function(){const A=document.createElement("link").relList;if(A&&A.supports&&A.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=e(s);fetch(s.href,r)}})();var k=1e-6,Q=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,A=arguments.length;A--;)t+=arguments[A]*arguments[A];return Math.sqrt(t)});function P(){var t=new Q(16);return Q!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Z(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function U(t,A,e){var i=e[0],s=e[1],r=e[2],o,n,h,l,d,E,m,c,p,a,f,g;return A===t?(t[12]=A[0]*i+A[4]*s+A[8]*r+A[12],t[13]=A[1]*i+A[5]*s+A[9]*r+A[13],t[14]=A[2]*i+A[6]*s+A[10]*r+A[14],t[15]=A[3]*i+A[7]*s+A[11]*r+A[15]):(o=A[0],n=A[1],h=A[2],l=A[3],d=A[4],E=A[5],m=A[6],c=A[7],p=A[8],a=A[9],f=A[10],g=A[11],t[0]=o,t[1]=n,t[2]=h,t[3]=l,t[4]=d,t[5]=E,t[6]=m,t[7]=c,t[8]=p,t[9]=a,t[10]=f,t[11]=g,t[12]=o*i+d*s+p*r+A[12],t[13]=n*i+E*s+a*r+A[13],t[14]=h*i+m*s+f*r+A[14],t[15]=l*i+c*s+g*r+A[15]),t}function O(t,A,e){var i=e[0],s=e[1],r=e[2];return t[0]=A[0]*i,t[1]=A[1]*i,t[2]=A[2]*i,t[3]=A[3]*i,t[4]=A[4]*s,t[5]=A[5]*s,t[6]=A[6]*s,t[7]=A[7]*s,t[8]=A[8]*r,t[9]=A[9]*r,t[10]=A[10]*r,t[11]=A[11]*r,t[12]=A[12],t[13]=A[13],t[14]=A[14],t[15]=A[15],t}function oA(t,A,e){var i=Math.sin(e),s=Math.cos(e),r=A[4],o=A[5],n=A[6],h=A[7],l=A[8],d=A[9],E=A[10],m=A[11];return A!==t&&(t[0]=A[0],t[1]=A[1],t[2]=A[2],t[3]=A[3],t[12]=A[12],t[13]=A[13],t[14]=A[14],t[15]=A[15]),t[4]=r*s+l*i,t[5]=o*s+d*i,t[6]=n*s+E*i,t[7]=h*s+m*i,t[8]=l*s-r*i,t[9]=d*s-o*i,t[10]=E*s-n*i,t[11]=m*s-h*i,t}function nA(t,A,e,i,s){var r=1/Math.tan(A/2),o;return t[0]=r/e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0?(o=1/(i-s),t[10]=(s+i)*o,t[14]=2*s*i*o):(t[10]=-1,t[14]=-2*i),t}var hA=nA;function aA(t,A,e,i){var s,r,o,n,h,l,d,E,m,c,p=A[0],a=A[1],f=A[2],g=i[0],v=i[1],u=i[2],I=e[0],B=e[1],C=e[2];return Math.abs(p-I)<k&&Math.abs(a-B)<k&&Math.abs(f-C)<k?Z(t):(d=p-I,E=a-B,m=f-C,c=1/Math.hypot(d,E,m),d*=c,E*=c,m*=c,s=v*m-u*E,r=u*d-g*m,o=g*E-v*d,c=Math.hypot(s,r,o),c?(c=1/c,s*=c,r*=c,o*=c):(s=0,r=0,o=0),n=E*o-m*r,h=m*s-d*o,l=d*r-E*s,c=Math.hypot(n,h,l),c?(c=1/c,n*=c,h*=c,l*=c):(n=0,h=0,l=0),t[0]=s,t[1]=n,t[2]=d,t[3]=0,t[4]=r,t[5]=h,t[6]=E,t[7]=0,t[8]=o,t[9]=l,t[10]=m,t[11]=0,t[12]=-(s*p+r*a+o*f),t[13]=-(n*p+h*a+l*f),t[14]=-(d*p+E*a+m*f),t[15]=1,t)}function J(){var t=new Q(3);return Q!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function G(t){var A=new Q(3);return A[0]=t[0],A[1]=t[1],A[2]=t[2],A}function cA(t){var A=t[0],e=t[1],i=t[2];return Math.hypot(A,e,i)}function y(t,A,e){var i=new Q(3);return i[0]=t,i[1]=A,i[2]=e,i}function H(t,A,e,i){return t[0]=A,t[1]=e,t[2]=i,t}function V(t,A,e){return t[0]=A[0]+e[0],t[1]=A[1]+e[1],t[2]=A[2]+e[2],t}function _(t,A,e){return t[0]=A[0]*e,t[1]=A[1]*e,t[2]=A[2]*e,t}function Y(t,A,e,i){return t[0]=A[0]+e[0]*i,t[1]=A[1]+e[1]*i,t[2]=A[2]+e[2]*i,t}function lA(t){var A=t[0],e=t[1],i=t[2];return A*A+e*e+i*i}function N(t,A){var e=A[0],i=A[1],s=A[2],r=e*e+i*i+s*s;return r>0&&(r=1/Math.sqrt(r)),t[0]=A[0]*r,t[1]=A[1]*r,t[2]=A[2]*r,t}var gA=lA;(function(){var t=J();return function(A,e,i,s,r,o){var n,h;for(e||(e=3),i||(i=0),s?h=Math.min(s*e+i,A.length):h=A.length,n=i;n<h;n+=e)t[0]=A[n],t[1]=A[n+1],t[2]=A[n+2],r(t,t,o),A[n]=t[0],A[n+1]=t[1],A[n+2]=t[2];return A}})();function dA(){var t=new Q(2);return Q!=Float32Array&&(t[0]=0,t[1]=0),t}function fA(t,A){var e=new Q(2);return e[0]=t,e[1]=A,e}function EA(t,A,e){return t[0]=A[0]+e[0],t[1]=A[1]+e[1],t}function uA(t){var A=t[0],e=t[1];return Math.hypot(A,e)}(function(){var t=dA();return function(A,e,i,s,r,o){var n,h;for(e||(e=2),i||(i=0),s?h=Math.min(s*e+i,A.length):h=A.length,n=i;n<h;n+=e)t[0]=A[n],t[1]=A[n+1],r(t,t,o),A[n]=t[0],A[n+1]=t[1];return A}})();function mA(t,A){const e=t.pos[0]-A.pos[0],i=t.pos[1]-A.pos[1],s=t.pos[2]-A.pos[2],r=e*e+i*i+s*s,o=.5*Math.sqrt(t.width*t.width+t.height*t.height),n=.5*Math.sqrt(A.width*A.width+A.height*A.height),h=o+n;return r<=h*h}class X{constructor(A){this.pos=A,this.vel=[0,0,0],this.width=1.6,this.height=2.4,this.usesGravity=!0,this.gravity=[0,-9.8,0],this.bounces=!1,this.restitution=.4,this.floorY=0}update(A,e){this.usesGravity&&Y(this.vel,this.vel,this.gravity,A),Y(this.pos,this.pos,this.vel,A),this.pos[1]<this.floorY&&(this.pos[1]=this.floorY,this.bounces&&Math.abs(this.vel[1])>.5?this.vel[1]=-this.vel[1]*this.restitution:this.vel[1]=0)}render(A){A.renderSprite(this.pos,this.width,this.height,1,0)}collidesWith(A){return mA(this,A)}}class pA extends X{constructor(A){super(A),this.width=1.6,this.height=2.4,this.aiming=!1,this.jogVel=y(0,0,0),this.joltVel=y(0,0,0),this.jogSpeed=5,this.joltSpeed=5,this.joltDecayRate=8}update(A,e){const i=e.controls,s=e.ball,{kickPressed:r,kickReleased:o,kickHeldTime:n,moveX:h,moveZ:l,aimTarget:d}=i.state,E=1e-4;if((h!==0||l!==0)&&!this.aiming){const p=y(h,0,l);if(gA(p)>E){N(p,p),_(this.joltVel,p,this.joltSpeed);const a=G(this.jogVel),f=J();_(f,p,.1),V(a,a,f),cA(a)>E?(N(a,a),_(this.jogVel,a,this.jogSpeed)):H(this.jogVel,0,0,0)}}V(this.vel,this.jogVel,this.joltVel);const m=Math.exp(-this.joltDecayRate*A);_(this.joltVel,this.joltVel,m),super.update(A,e),!s.carried&&s.collidesWith(this)&&s.pickup(this);const c=fA(0,-10);if(d&&EA(c,c,d),s.carried&&s.carrier===this&&(r&&(this.aiming=!0),o&&d)){const p=n<.25,a=uA(c);if(a>.1){const f=-this.gravity[1],g=45*Math.PI/180,v=Math.sin(2*g),u=p?15:Math.sqrt(a*f/v),I=y(c[0],0,c[1]);N(I,I);const B=y(I[0]*Math.cos(g),Math.sin(g),I[2]*Math.cos(g));V(s.pos,this.pos,[0,0,-3]),s.launch(B,u)}this.aiming=!1}this.aiming&&e.aimTarget.setPosition([this.pos[0]+c[0],.002,this.pos[2]+c[1]])}}class vA extends X{constructor(A){super(A),this.carried=!1,this.carrier=null,this.width=1.6,this.height=2.4,this.bounces=!0}update(A,e){if(this.carried&&this.carrier){const i=y(0,0,-1),s=G(this.carrier.pos);V(this.pos,s,i)}else super.update(A,e),this.pos[1]<=this.floorY&&_(this.vel,this.vel,.99)}render(A){A.renderSprite(this.pos,this.width,this.height,0,1)}pickup(A){this.carried=!0,this.carrier=A,H(this.pos,A.pos[0],A.pos[1],A.pos[2]-1),H(this.vel,0,0,0)}launch(A,e){this.carried=!1,this.carrier=null,_(this.vel,A,e)}}class IA{constructor(A=[0,.001,0]){this.pos=G(A),this.size=2,this.spriteCoord=[0,3]}setPosition(A){this.pos[0]=A[0],this.pos[2]=A[2]}render(A){const e=A.gl;e.useProgram(A.program),e.bindVertexArray(A.quadVao);const[i,s]=this.spriteCoord,r=i/A.sheetCols,o=s/A.sheetRows,n=(i+1)/A.sheetCols,h=(s+1)/A.sheetRows;e.uniform4f(A.uTileUV,r,o,n,h);const l=P();U(l,l,[this.pos[0],.001,this.pos[2]]),oA(l,l,-Math.PI/2),O(l,l,[this.size,this.size,1]),e.uniformMatrix4fv(A.uModel,!1,l),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}}function W(t,A,e){const i=(n,h)=>{const l=t.createShader(h);if(!l)throw new Error("Failed to create shader");if(t.shaderSource(l,n),t.compileShader(l),!t.getShaderParameter(l,t.COMPILE_STATUS))throw new Error(t.getShaderInfoLog(l));return l},s=i(A,t.VERTEX_SHADER),r=i(e,t.FRAGMENT_SHADER),o=t.createProgram();if(t.attachShader(o,s),t.attachShader(o,r),t.linkProgram(o),!t.getProgramParameter(o,t.LINK_STATUS))throw new Error(t.getProgramInfoLog(o));return o}async function BA(t){const A=new Image;return A.src=t,await A.decode(),A}function CA(t,A,e,i=1){const o=t*2/1.6/i,n=A*2/2/i,h=[0,0,0,.5,.5],l=[];for(let d=0;d<=e;d++){const E=d/e*2*Math.PI,m=Math.cos(E)*t,c=Math.sin(E)*A,p=m/(t*2)*o+.5,a=c/(A*2)*n+.5;h.push(m,0,c,p,a),d>0&&l.push(0,d,d+1)}return{vertices:new Float32Array(h),indices:new Uint16Array(l)}}function TA(t=160,A=170,e=50,i=50,s=.4){const r=[],o=[];let n=0;const h=(a,f,g,v,u)=>{const I=g-a,B=v-f,C=Math.hypot(I,B),M=-B/C,w=I/C,T=u/2,S=a+M*T,F=f+w*T,b=a-M*T,x=f-w*T,tA=g+M*T,eA=v+w*T,iA=g-M*T,sA=v-w*T;r.push(S,0,F,tA,0,eA,iA,0,sA,b,0,x),o.push(n,n+1,n+2,n,n+2,n+3),n+=4},l=t/2,d=A/2,E=64;for(let a=0;a<E;a++){const f=a/E*2*Math.PI,g=(a+1)/E*2*Math.PI,v=Math.cos(f)*l,u=Math.sin(f)*d,I=Math.cos(g)*l,B=Math.sin(g)*d;h(v,u,I,B,s)}const m=[[-i/2,-i/2],[i/2,-i/2],[i/2,i/2],[-i/2,i/2]];for(let a=0;a<4;a++){const[f,g]=m[a],[v,u]=m[(a+1)%4];h(f,g,v,u,s)}function c(a){const f=a>0?-1:1,g=[];for(let v=0;v<=1e3;v++){const u=-Math.PI+v/1e3*2*Math.PI,I=Math.sin(u)*e,B=a+f*Math.cos(u)*e,C=I/l,M=B/d;C*C+M*M<=1&&g.push(u)}return g.length===0?[-Math.PI/3,Math.PI/3]:[g[0],g[g.length-1]]}const p=40;for(let a of[-A/2,A/2]){const f=a>0?-1:1,[g,v]=c(a);for(let u=0;u<p;u++){const I=g+u/p*(v-g),B=g+(u+1)/p*(v-g),C=Math.sin(I)*e,M=a+f*Math.cos(I)*e,w=Math.sin(B)*e,T=a+f*Math.cos(B)*e;h(C,M,w,T,s)}}return{vertices:new Float32Array(r),indices:new Uint16Array(o)}}const D=170,MA=80,q=D/2;class yA{constructor(A,e,i){this.gl=A,this.canvas=e,this.spriteSheet=i,this.sheetCols=32,this.sheetRows=32,this.setupMainProgram(),this.setupLineProgram(),this.setupSpriteGeometry(),this.setupField(),this.setupGoalposts(),this.setupCamera(),this.setupSpritesheet(),A.enable(A.DEPTH_TEST),A.depthFunc(A.LEQUAL)}setupSpritesheet(){const A=this.gl;A.pixelStorei(A.UNPACK_ALIGNMENT,1),A.pixelStorei(A.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),A.pixelStorei(A.UNPACK_FLIP_Y_WEBGL,!1),this.texture=A.createTexture(),A.bindTexture(A.TEXTURE_2D,this.texture),A.texImage2D(A.TEXTURE_2D,0,A.RGBA,A.RGBA,A.UNSIGNED_BYTE,this.spriteSheet),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MIN_FILTER,A.NEAREST),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MAG_FILTER,A.NEAREST),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_S,A.CLAMP_TO_EDGE),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_T,A.CLAMP_TO_EDGE),A.activeTexture(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,this.texture)}setupMainProgram(){const A=`#version 300 es
      in vec3 a_position;
      in vec2 a_texcoord;
      uniform mat4 u_projection, u_view, u_model;
      out vec2 v_texcoord;
      void main() {
        gl_Position = u_projection * u_view * u_model * vec4(a_position, 1.0);
        v_texcoord = a_texcoord;
      }`,e=`#version 300 es
precision mediump float;

uniform sampler2D u_texture;
uniform vec4 u_tileUV;

in vec2 v_texcoord;
out vec4 outColor;

void main() {
  vec2 tileUV = mod(v_texcoord, 1.0);
  vec2 texCoord = mix(u_tileUV.xy, u_tileUV.zw, tileUV);
  vec4 texColor = texture(u_texture, texCoord);

  if (texColor.a < 0.01) discard; // Skip fully transparent fragments

  outColor = texColor;
}
`;this.program=W(this.gl,A,e),this.uProjection=this.gl.getUniformLocation(this.program,"u_projection"),this.uView=this.gl.getUniformLocation(this.program,"u_view"),this.uModel=this.gl.getUniformLocation(this.program,"u_model"),this.uTileUV=this.gl.getUniformLocation(this.program,"u_tileUV"),this.uTexture=this.gl.getUniformLocation(this.program,"u_texture"),this.aPos=this.gl.getAttribLocation(this.program,"a_position"),this.aUV=this.gl.getAttribLocation(this.program,"a_texcoord")}setupLineProgram(){const A=`#version 300 es
    in vec3 a_position;
    uniform mat4 u_projection;
    uniform mat4 u_view;
    uniform mat4 u_model;
    void main() {
    gl_Position = u_projection * u_view * u_model * vec4(a_position, 1.0);
    }`,e=`#version 300 es
    precision mediump float;
    out vec4 outColor;
    void main() {
    outColor = vec4(1, 1, 1, 1);
    }`;this.lineProgram=W(this.gl,A,e),this.lineProj=this.gl.getUniformLocation(this.lineProgram,"u_projection"),this.lineView=this.gl.getUniformLocation(this.lineProgram,"u_view"),this.lineModel=this.gl.getUniformLocation(this.lineProgram,"u_model"),this.linePos=this.gl.getAttribLocation(this.lineProgram,"a_position")}setupSpriteGeometry(){const A=this.gl;A.enable(A.BLEND),A.blendFunc(A.SRC_ALPHA,A.ONE_MINUS_SRC_ALPHA),A.depthMask(!0);const e=new Float32Array([-.5,0,0,1,.5,0,1,1,.5,1,1,0,-.5,1,0,0]),i=new Uint16Array([0,1,2,0,2,3]);this.quadVao=this.gl.createVertexArray(),this.gl.bindVertexArray(this.quadVao);const s=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,s),this.gl.bufferData(this.gl.ARRAY_BUFFER,e,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPos,2,this.gl.FLOAT,!1,16,0),this.gl.enableVertexAttribArray(this.aPos),this.gl.vertexAttribPointer(this.aUV,2,this.gl.FLOAT,!1,16,8),this.gl.enableVertexAttribArray(this.aUV);const r=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,r),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,i,this.gl.STATIC_DRAW)}setupField(){const A=this.gl,{vertices:e,indices:i}=CA(MA,q,64,16);this.fieldVao=this.gl.createVertexArray(),this.gl.bindVertexArray(this.fieldVao);const s=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,s),this.gl.bufferData(this.gl.ARRAY_BUFFER,e,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPos,3,this.gl.FLOAT,!1,20,0),this.gl.enableVertexAttribArray(this.aPos),this.gl.vertexAttribPointer(this.aUV,2,this.gl.FLOAT,!1,20,12),this.gl.enableVertexAttribArray(this.aUV);const r=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,r),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,i,this.gl.STATIC_DRAW),this.fieldIndices=i.length,this.fieldLineMesh=TA(),this.lineVao=A.createVertexArray(),A.bindVertexArray(this.lineVao);const o=A.createBuffer();A.bindBuffer(A.ARRAY_BUFFER,o),A.bufferData(A.ARRAY_BUFFER,this.fieldLineMesh.vertices,A.STATIC_DRAW);const n=A.createBuffer();A.bindBuffer(A.ELEMENT_ARRAY_BUFFER,n),A.bufferData(A.ELEMENT_ARRAY_BUFFER,this.fieldLineMesh.indices,A.STATIC_DRAW),A.vertexAttribPointer(this.linePos,3,A.FLOAT,!1,12,0),A.enableVertexAttribArray(this.linePos)}setupGoalposts(){this.goalPostPositions=[[-9,0,D],[-3,0,D],[3,0,D],[9,0,D],[-9,0,0],[-3,0,0],[3,0,0],[9,0,0]]}setupCamera(){this.projection=P(),hA(this.projection,Math.PI/4,this.canvas.width/this.canvas.height,.1,1e3),this.view=P(),this.model=P()}renderSprite(A,e,i,s,r){const{gl:o,program:n,quadVao:h,uModel:l,uTileUV:d,sheetCols:E,sheetRows:m}=this;o.useProgram(n),o.bindVertexArray(h);const c=P();U(c,c,A),O(c,c,[e,i,1]),o.uniformMatrix4fv(l,!1,c);const p=s/E,a=r/m,f=(s+1)/E,g=(r+1)/m;o.uniform4f(d,p,a,f,g),o.drawElements(o.TRIANGLES,6,o.UNSIGNED_SHORT,0)}renderScene(A,e){const i=this.gl;i.viewport(0,0,this.canvas.width,this.canvas.height),i.clearColor(.2,.6,.2,1),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT);const s=y(A.player.pos[0],A.player.pos[1]+10,A.player.pos[2]+15),r=y(A.player.pos[0],A.player.pos[1],A.player.pos[2]-20);aA(this.view,s,r,[0,1,0]),i.useProgram(this.program),i.uniformMatrix4fv(this.uProjection,!1,this.projection),i.uniformMatrix4fv(this.uView,!1,this.view),i.activeTexture(i.TEXTURE0),i.uniform1i(this.uTexture,0),i.bindVertexArray(this.fieldVao),Z(this.model),U(this.model,this.model,[0,0,q]),i.uniformMatrix4fv(this.uModel,!1,this.model);const o=0,n=2,h=o/this.sheetCols,l=n/this.sheetRows,d=(o+1)/this.sheetCols,E=(n+1)/this.sheetRows;i.uniform4f(this.uTileUV,h,l,d,E),i.drawElements(i.TRIANGLES,this.fieldIndices,i.UNSIGNED_SHORT,0),i.useProgram(this.lineProgram),i.uniformMatrix4fv(this.lineProj,!1,this.projection),i.uniformMatrix4fv(this.lineView,!1,this.view);const m=P();U(m,this.model,[0,.001,0]),i.uniformMatrix4fv(this.lineModel,!1,m),i.bindVertexArray(this.lineVao),i.drawElements(i.TRIANGLES,this.fieldLineMesh.indices.length,i.UNSIGNED_SHORT,0),i.useProgram(this.program),i.bindVertexArray(this.quadVao);const c=1,p=2,a=c/this.sheetCols,f=p/this.sheetRows,g=(c+1)/this.sheetCols,v=(p+1)/this.sheetRows;i.uniform4f(this.uTileUV,a,f,g,v);for(let u=0;u<this.goalPostPositions.length;u++){const[I,B,C]=this.goalPostPositions[u],w=u%4===0||u%4===3?6:10,T=s[0]-I,S=s[2]-C,F=Math.sqrt(T*T+S*S),b=F>50?1.5:F>150?2:1,x=P();U(x,x,[I,B,C]),O(x,x,[b,w,1]),i.uniformMatrix4fv(this.uModel,!1,x),i.drawElements(i.TRIANGLES,6,i.UNSIGNED_SHORT,0)}i.bindVertexArray(this.quadVao);for(const u of e)u instanceof X?u.render(this):this.renderSprite(u.pos,u.width,u.height,1,0);A.player.aiming&&A.aimTarget.render(this)}}var R,K,$,AA;class QA{constructor(A){z(this,R);this.state={moveX:0,moveZ:0,kickPressed:!1,kickReleased:!1,kickHeldTime:0,aimTarget:null},this.keys={},this.lastKeys={},this.touchMove=null,this.touchAim=null,this.kPressTime=0,A.addEventListener("touchstart",L(this,R,K).bind(this),{passive:!1}),A.addEventListener("touchmove",L(this,R,$).bind(this),{passive:!1}),A.addEventListener("touchend",L(this,R,AA).bind(this)),window.addEventListener("keydown",e=>this.keys[e.key.toLowerCase()]=!0),window.addEventListener("keyup",e=>this.keys[e.key.toLowerCase()]=!1)}endUpdate(){this.state.moveX=0,this.state.moveZ=0,this.state.kickPressed=!1,this.state.kickReleased=!1}update(A){var r;const e=!!this.keys.k,i=!!this.lastKeys.k;if(e&&!i&&(this.state.kickPressed=!0,this.kPressTime=0,this.state.aimTarget=[0,0]),e?(this.kPressTime+=A,this.state.aimTarget&&(this.keys.a&&(this.state.aimTarget[0]-=30*A),this.keys.d&&(this.state.aimTarget[0]+=30*A),this.keys.w&&(this.state.aimTarget[1]-=30*A),this.keys.s&&(this.state.aimTarget[1]+=30*A))):(this.keys.a&&(this.state.moveX-=1),this.keys.d&&(this.state.moveX+=1),this.keys.w&&(this.state.moveZ-=1),this.keys.s&&(this.state.moveZ+=1)),!e&&i&&(this.state.kickReleased=!0),this.state.kickHeldTime=this.kPressTime,this.touchMove&&!this.touchAim&&(this.state.moveX=this.touchMove.dx/50,this.state.moveZ=this.touchMove.dy/50),this.touchAim){this.kPressTime+=A;const o=this.touchAim.dx,n=this.touchAim.dy;console.log("Touch aim:",o,n);const h=10;this.state.aimTarget=[-o/h,-n/h],this.state.kickHeldTime=this.kPressTime}const s=(r=navigator.getGamepads)==null?void 0:r.call(navigator)[0];if(s){this.state.moveX+=s.axes[0]||0,this.state.moveZ+=-(s.axes[1]||0);const o=s.axes[2]||0,n=-(s.axes[3]||0),h=Math.hypot(o,n);h>.2&&(this.state.aimTarget=[o/h,n/h])}this.lastKeys={...this.keys}}getState(){return this.state}}R=new WeakSet,K=function(A){A.preventDefault();for(const e of A.changedTouches)e.clientX<window.innerWidth/2?this.touchMove={id:e.identifier,startX:e.clientX,startY:e.clientY,dx:0,dy:0}:(this.touchAim={id:e.identifier,startX:e.clientX,startY:e.clientY,dx:0,dy:0},this.state.kickPressed=!0,this.kPressTime=0)},$=function(A){A.preventDefault();for(const e of A.changedTouches)this.touchMove&&e.identifier===this.touchMove.id&&(this.touchMove.dx=e.clientX-this.touchMove.startX,this.touchMove.dy=e.clientY-this.touchMove.startY),this.touchAim&&e.identifier===this.touchAim.id&&(this.touchAim.dx=e.clientX-this.touchAim.startX,this.touchAim.dy=e.clientY-this.touchAim.startY)},AA=function(A){A.preventDefault();for(const e of A.changedTouches)this.touchAim&&e.identifier===this.touchAim.id&&(this.touchAim=null,this.state.kickReleased=!0),this.touchMove&&e.identifier===this.touchMove.id&&(this.touchMove=null)};class wA{constructor(A,e){if(this.canvas=A,this.gl=A.getContext("webgl2"),!this.gl)throw new Error("WebGL2 not supported");this.renderer=new yA(this.gl,A,e),this.controls=new QA(A),this.entities=[],this.aimTarget=new IA([5,.001,150]),this.player=new pA(y(0,0,170)),this.entities.push(this.player),this.ball=new vA(y(0,0,160)),this.entities.push(this.ball),this.player.vel[2]=-5,this.lastTime=performance.now(),requestAnimationFrame(this.loop.bind(this))}start(){requestAnimationFrame(this.loop.bind(this))}loop(A){const e=(A-this.lastTime)/1e3;this.lastTime=A,this.controls.update(e);for(const i of this.entities)i.update(e,this);this.renderer.renderScene(this,this.entities),this.controls.endUpdate(),requestAnimationFrame(this.loop.bind(this))}}const RA="data:image/png;base64,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AQAACAAAQAAAgAAAAAQAACAAAAABAAAIAABAAAAAAgAAEAAAgAAAAAQAACAAAAABAAAIAABAAAAAAgAAEAAAgAAAAAEAAAgAAEAAAAACAAAQAACAAAAABAAAIAAAAAEAAAgAAEAAAAACAAAQAACAAAAABAAAIAAAAAEAAAIAABAAAIAAAAAEAAAgAAAAAQAACAAAQAAAAAIAABAAAIAAAAAEAAAgAAAAAQAACAAAQAAAAAIAAAQAACAAAAABAAAIAABAAAAAAgAAEAAAgAAAAAQAACAAAAABAAAIAABAAAAAAgAAEAAAgAAAAAQAAAgASwAAAgAAEAAAgAAAAAQAACAAAAABAAAIAABAAAAAAgAAEAAAgAAAAAQAACAAAAABAAAIAABAAAAAAgAABAAAIAAAAAEAAAgAAEAAAAACAAAQAACAAAAABAAAIAAAAAEAAAgAAEAAAAACAAAQAACAAAAABAAACAAAQAAAAAIAABAAAIAAAAAEAAAgAAAAAQAACAAAQAAAAAIAABAAAIAAAAAEAAAgAAAAAQAACAAAEAAAgAAAAAQAACAAAAABAAAIAABAAAAAAgAAEAAAgAAAAAQAACAAAAABAAAIAABAAAAAAgAAWMRwNE6tAgDYAQAABAAAIAAAAAEAAAgAAEAAAAACAAAQAACAAAAABAAAIAAAAAEAAAgAAEAAAIAAAAAEAAAgAAAAAQAACAAAQAAAAAIAABAAAIAAAAAEAAAgAAAAAQAACAAAQAAAAAIAABAAAIAAAAABAAAIAABAAAAAAgAAEAAAgAAAAAQAACAAAAABAAAIAABAAAAAAgAAEAAAgAAAAAQAACAAAAABAAACAAAQAACAAAAABAAAIAAAAAEAAAgAAEAAAAACAAAQAACAAAAABAAAIAAAAAEAAAgAAEAAAAACAAAEAAAgAAAAAQAACAAAQAAAAAIAABAAAIAAAAAEAAAgAAAAAQAACAAAQAAAAAIAABAAAIAAAAAEAAAgAABAAAAAAgAAEAAAgAAAAAQAACAAAAABAAAIAABAAAAAAgAAEAAAgAAAAAQAACAAAAABAAAIAABAAACAAAAABAAAIAAAAAEAAAgAAEAAAAACAAAQAACAAAAABAAAIAAAAAEAAAgAAEAAAAACAAAQAACAAAAAAQAACAAAQAAAAAIAABAAAIAAAAAEAAAgAAAAAQAACAAAQAAAAAIAABAAAIAAAAAEAAAgAAAAAQAAAgAAEAAAgAAAAAQAACAAAAABAAAIAABAAAAAAgAAEAAAgAAAAAQAACAAAAABAAAIAABAAAAAAgAABAAAIAAAAAEAAAgAAEAAAAACAAAQAACAAAAABAAAIAAAAAEAAAgAAEAAAAACAAAQAACAAAAAFjEcjVOrAAB2AAAAAQAACAAAQAAAAAIAABAAAIAAAAAEAAAgAAAAAQAACAAAQAAAAAIAABAAACAAAAABAAAIAABAAAAAAgAAEAAAgAAAAAQAACAAAAABAAAIAABAAAAAAgAAEAAAgAAAAAQAACAAAEAAAAACAAAQAACAAAAABAAAIAAAAAEAAAgAAEAAAAACAAAQAACAAAAABAAAIAAAAAEAAAgAAEAAAIAAAAAEAAAgAAAAAQAACAAAQAAAAAIAABAAAIAAAAAEAAAgAAAAAQAACAAAQAAAAAIAABAAAIAAAAAEAAAIAABAAAAAAgAAEAAAgAAAAAQAACAAAAABAAAIAABAAAAAAgAAEAAAgAAAAAQAACAAAAABAAAIAAAQAACAAAAABAAAIAAAAAEAAAgAAEAAAAACAAAQAACAAAAABAAAIAAAAAEAAAgAAEAAAAACAAAQAAAgAAAAAQAACAAAQAAAAAIAABAAAIAAAAAEAAAgAAAAAQAACAAAQAAAAAIAABAAAIAAAAAEAAAgAABAAAAAAgAAEAAAgAAAAAQAACAAAAABAAAIAABAAAAAAgAAEAAAgAAAAAQAACAAAAABAAAIAABAAACAAAAABAAAIAAAAAEAAAgAAEAAAAACAAAQAACAAAAABAAAIAAAAAEAAAgAAEAAAAACAAAQAACAAAAABAAACAAAQAAAAAIAABAAAIAAAAAEAAAgAAAAAQAACAAAQAAAAAIAABAAAIAAAAAEAAAgAACARQxH49QqAIAdAABAAAAAAgAAEAAAgAAAAAQAACAAAAABAAAIAABAAAAAAgAAEAAAgAAAAAQAAAgAAEAAAAACAAAQAACAAAAABAAAIAAAAAEAAAgAAEAAAAACAAAQAACAAAAABAAAIAAAAAEAAAgAABAAlgAABAAAIAAAAAEAAAgAAEAAAAACAAAQAACAAAAABAAAIAAAAAEAAAgAAEAAAAACAAAQAACAAAAABAAACAAAQAAAAAIAABAAAIAAAAAEAAAgAAAAAQAACAAAQAAAAAIAABAAAIAAAAAEAAAgAAAAAQAACAAAEAAAgAAAAAQAACAAAAABAAAIAABAAAAAAgAAEAAAgAAAAAQAACAAAAABAAAIAABAAAAAAgAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC0UFL2gqOba2lExOaTk8RyAbTbre83U6vQH/vbR8nCAYCDBNCPgYAdAAMBBwkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgMX9BabSfRAEM8PkAAAAAElFTkSuQmCC";function xA(t){const A=document.getElementById("glcanvas");if(!A)throw console.error("Canvas element not found"),new Error("Canvas element not found");A.width=window.innerWidth,A.height=window.innerHeight,new wA(A,t).start()}BA(RA).then(t=>{if(!t.complete)throw console.error("Failed to load sprite sheet"),new Error("Sprite sheet not loaded");xA(t)});
